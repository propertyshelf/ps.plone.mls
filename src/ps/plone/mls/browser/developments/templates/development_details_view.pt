<html xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="ps.plone.mls"
      tal:omit-tag="">
  <head>
    <metal:baseslot fill-slot="base"
        tal:define="item view/item | nothing;
                    id item/id/value | nothing;">
      <base tal:attributes="href string:${plone_view/renderBase}${id}" /><!--[if lt IE 7]></base><![endif]-->
    </metal:baseslot>
  </head>

  <body>
    <metal:main fill-slot="main">
      <article class="mls detail development"
           metal:define-macro="main"
           tal:define="item view/item | nothing;
                       images item/pictures | nothing;
                       title item/title/value | nothing;
                       id item/id/value | nothing;
                       base_link string:${plone_view/renderBase};
                       seperator python: '' if base_link.endswith('/') else '/';
                       self_link string:${plone_view/renderBase}${seperator}${id};
                       amenities item/amenities_order/value | nothing;
                       amenities_dict item/amenities_lookup/value | nopthing;">

        <div id="viewlet-above-content-title" tal:content="structure provider:plone.abovecontenttitle" tal:condition="not:ajax_load" />
        <div id="viewlet-below-content-title" tal:content="structure provider:plone.belowcontenttitle" tal:condition="not:ajax_load" />

        <div id="viewlet-above-content-body" tal:content="structure provider:plone.abovecontentbody" tal:condition="not:ajax_load" />

        <div id="content-core" tal:condition="item">
          <section class="development__amenities" tal:condition="amenities">
            <tal:amenity tal:repeat="amenity amenities">
              <span aria-hidden="true"
                  tal:define="amentity_label python:amenities_dict[amenity]"
                  tal:attributes="class string:amenitiesicon ${amenity};
                                  aria-label amentity_label;" >
              </span>
            </tal:amenity>
          </section>
          <section class="development__overview">
            <h2 class="" i18n:translate="">Overview</h2>
            <p class="documentDescription">
              <span tal:replace="structure item/description/value | nothing" />
            </p>
            <!-- temporary use area image -->
            <picture class="description__picture"
                tal:define="image item/area_picture | nothing"
                tal:condition="image"><a href="" rel="prettyPhoto[item]"
                tal:attributes="href image/value"><img src="" title="" alt=""
                tal:attributes="src image/value;
                                title title;
                                alt title;" /></a></picture>
            <p class="overview__long_description"
                tal:define="text item/long_description | nothing"
                tal:condition="text"
                tal:content="structure text/value"></p>
              <div class="visualClear" />
          </section>
          <section class="development__groups"
              tal:define="groups item/groups | nothing"
              tal:condition="groups">
            <h2 i18n:translate="">Properties Available</h2>
            <ul>
              <li tal:repeat="group groups">
                <tal:groups
                      tal:define="group_id group/id/value | nothing;
                                  group_listings_link string:${self_link}/listings?group=${group_id}">
                  <a href=""
                      tal:attributes="href group_listings_link"
                      tal:content="group/title/value | string:-">[Title]</a>
                </tal:groups>
              </li>
            </ul>
          </section>

          <section class="development__projectmap"
              tal:define="projectmap item/project_map_embedding | nothing"
              tal:condition="projectmap">
            <h2 i18n:translate="">Project Map</h2>
            <div class="projectmap"
                  tal:content="structure projectmap/value"></div>
            <div class="pdf_download"
                tal:define="file item/project_map_pdf | item/logo | nothing;
                            file_href file/value | nothing;
                            download_title string:${title} | nothing;"
                tal:condition="file_href">
                <a class="download"
                  tal:attributes="href file_href;
                                  download download_title;
                                  target string:_blank;"
                  i18n:translate="">Download PDF</a>

            </div>
          </section>

          <section class="development__gallery"
              tal:condition="images"
              tal:define="lead_image view/lead_image | nothing;
                          use_fotorama view/use_fotorama | nothing;
                          use_galleria view/use_galleria | nothing;">
            <h2 i18n:translate="">Gallery</h2>
            <tal:leadimage tal:condition="python: not images and lead_image">
              <a href="" rel="prettyPhoto[listing]" class="preview"
                 tal:condition="lead_image"
                 tal:attributes="href lead_image/large;
                                 title lead_image/title | nothing;"><img src=""
                 tal:attributes="src lead_image/preview" /></a>
            </tal:leadimage>

            <tal:fotorama tal:condition="python: images and use_fotorama">
              <div class="fotorama"
                   data-allow-full-screen="native"
                   data-autoplay="true"
                   data-loop="true"
                   data-nav="thumbs"
                   data-ratio="3/2"
                   data-width="100%">
                <tal:images tal:repeat="image images">
                  <a href="" data-caption=""
                     tal:define="caption image/title;
                                 description image/description | nothing;
                                 caption python: description and ' - '.join([caption, description]) or caption"
                     tal:attributes="href python: image.get('url');
                                     data-caption caption"><img src="" alt=""
                     tal:attributes="src python: image.get('thumb');
                                     title image/title;
                                     alt image/description;" /></a>
                </tal:images>
              </div>
              <script type="text/javascript">
                jQuery(function(jq) {
                  jq('#listing-images > div').addClass('fotorama');
                  jq('.fotorama').fotorama();
                });
              </script>
            </tal:fotorama>

            <tal:galleria tal:condition="python: images and use_galleria">
              <ul class="thumbnails"
                  tal:condition="images" style="list-style: none; margin-left: 0;">
                <li tal:repeat="image images" style="display: inline-block; padding: 0.5em;"><a href="" rel="prettyPhoto[gallery]"
                    tal:attributes="href image/get;
                                    title image/title | nothing;"><img src="" alt="" title=""
                    tal:attributes="src python: image.get('thumb');
                                    alt image/title | nothing;
                                    title image/description | nothing" /></a></li>
              </ul>
              <script type="text/javascript" src="++resource++plone.mls.listing.javascript/galleria-1.2.2.js"></script>
              <script type="text/javascript" src="++resource++plone.mls.listing.javascript/classic/galleria.classic.min.js"></script>
            </tal:galleria>
          </section>
          <section class="video_embedding"
                  tal:define="video item/video_embedding | nothing"
                  tal:condition="video">
            <h2 i18n:translate="">Video</h2>
            <div class="video"
                  tal:content="structure video/value"></div>
          </section>

          <section class="development__area"
              tal:define="text item/area_description | nothing"
              tal:condition="text">
            <h2 i18n:translate="">About the Area</h2>
            <picture class="area__picture"
                tal:define="image item/area_picture | nothing"
                tal:condition="image"><a href="" rel="prettyPhoto[item]"
                tal:attributes="href image/value"><img src="" title="" alt=""
                tal:attributes="src image/value;
                                title title;
                                alt title;" /></a></picture>
            <p class="area__description"
                tal:content="text/value"></p>
          </section>
          <section class="development__map"
               tal:define="js view/javascript_map | nothing"
               tal:condition="js">
            <h2 i18n:translate="" tal:replace="nothing">Map & Distances</h2>
            <h2 i18n:translate="">Map & Distances</h2>
            <div class="map__canvas" id="map"
                tal:attributes="id view/map_id">Please enable JavaScript to show the Map.</div>
            <script type="text/javascript" tal:content="structure js"></script>
          </section>

          <section class="development__distances">
            DISTANCE ICONS
          </section>
          <section class="development__phases"
              tal:define="phases item/phases | nothing"
              tal:condition="phases">
            <h2 i18n:translate="">Construction Status</h2>

            <table class="listing phases__table">
              <thead
                  tal:define="titles view/titles_for_phases | nothing"
                  tal:condition="titles">
                <tr>
                  <th class="title" tal:content="titles/title | nothing">[Phase Name]</th>
                  <th class="units" tal:content="titles/units | nothing">[Number of Units]</th>
                  <th class="status" tal:content="titles/status | nothing">[Status]</th>
                  <th class="completion_date" tal:content="titles/completion_date | nothing">[Completion Date]</th>
                </tr>
              </thead>
              <tbody>
                <tr tal:repeat="phase phases">
                  <tal:phases
                      tal:define="phase_id phase/id/value | nothing;
                                  phase_listings_link string:${self_link}/listings?phase=${phase_id}">
                    <td class="title"><a href=""
                        tal:attributes="href phase_listings_link"
                        tal:content="phase/title/value | string:-">[Title]</a></td>
                    <td class="units" tal:content="phase/units/value | string:-">[Units]</td>
                    <td class="status" tal:content="phase/status/value | string:-">[Status]</td>
                    <td class="completion_date" tal:content="phase/completion_date/value | string:-">[Completion Date]</td>
                  </tal:phases>
                </tr>
              </tbody>
            </table>
          </section>
          <section class="development__representatives"
              tal:define="representatives item/representatives | nothing"
              tal:condition="representatives">
            <h2 i18n:translate="">Meet the Developers</h2>
            <div class="visualClear representatives__item"
                tal:repeat="agent representatives">

              <tal:agent
                  tal:define="avatar agent/avatar | nothing;
                              name agent/name | nothing;"
                  tal:condition="name">
                <picture class="representative__avatar"
                    tal:condition="avatar"><a href="" rel="prettyPhoto[item]"
                    tal:attributes="href avatar/value"><img src="" title="" alt=""
                    tal:attributes="src avatar/value;
                                    title name/value;
                                    alt name/value;" /></a></picture>
                <h3 class="representative__name"
                    tal:content="name/value">[Developer Name]</h3>
                <p class="representative__user_title"
                    tal:define="user_title agent/user_title/value | nothing"
                    tal:condition="user_title"
                    tal:content="user_title">[Developer Title]</p>
                <p class="representative__personal_description"
                    tal:define="text agent/personal_description/value | nothing"
                    tal:condition="text"
                    tal:content="text">[Personal Description]</p>
              </tal:agent>
            </div>
          </section>

          <section class="development__contact"
              itemscope itemtype="http://schema.org/LocalBusiness"
              tal:condition="view/show_section_contact | nothing">
            <h2 i18n:translate="">Contact</h2>
            <tal:form
                tal:define="form view/contact_form"
                tal:condition="form">
              <form action=""
                  tal:condition="not: form/already_sent"
                  tal:replace="structure form/render"></form>
            </tal:form>
            <tal:contact_info
                tal:define="contact_info view/contact_info | nothing;
                            agency contact_info/agency | nothing;
                            agent contact_info/agent | nothing;
                            name agency/title | nothing;
                            description agency/description | nothing;
                            address agency/address | nothing;
                            office_phone agency/office_phone | nothing;
                            office_fax agency/office_fax | nothing;
                            website agency/website | nothing;
                            email agency/email | nothing;"
                tal:condition="contact_info">
              <h3 itemprop="name"
                  tal:condition="name"
                  tal:content="name/value">[Agency Name]</h3>
              <p itemprop="description"
                  tal:condition="description"
                  tal:content="description/value">[Description]</p>

              <address>
                <div itemprop="address" itemscope itemtype="http://schema.org/PostalAddress" >
                  <span itemprop="streetAddress"
                    tal:condition="address"
                    tal:content="address/value">[address]</span></div>
                <div itemprop="telephone"
                    tal:condition="office_phone"
                    tal:content="office_phone/value">[office_phone]</div>
                <div itemprop="faxNumber"
                    tal:condition="office_fax"
                    tal:content="office_fax/value">[office_fax]</div>
                <div itemprop="url"
                    tal:condition="website"><a href=""
                    tal:content="website/value"
                    tal:attributes="href website/value">[website]</a></div>
                <div itemprop="email"
                    tal:condition="email"
                    tal:content="email/value">[email]</div>
              </address>
            </tal:contact_info>
          </section>
        </div>

        <div id="viewlet-below-content-body" tal:content="structure provider:plone.belowcontentbody" tal:condition="not:ajax_load" />
      </article>
    </metal:main>
  </body>
</html>
